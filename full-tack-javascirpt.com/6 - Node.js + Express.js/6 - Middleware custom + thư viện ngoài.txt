[Ngá»¯ cáº£nh #6] Middleware custom + thÆ° viá»‡n ngoÃ i

ðŸ“¦ CÃ i thÆ° viá»‡n:
---------------------
npm install cors morgan helmet

ðŸ“„ server.js
---------------------
const express = require('express');
const cors = require('cors');
const morgan = require('morgan');
const helmet = require('helmet');

const userRoutes = require('./routes/user.route');
const app = express();

// DÃ¹ng middleware ngoÃ i
app.use(cors());
app.use(morgan('dev'));
app.use(helmet());

// Middleware express
app.use(express.json());

// Routes
app.use('/users', userRoutes);

// Middleware xá»­ lÃ½ lá»—i cuá»‘i cÃ¹ng
app.use((err, req, res, next) => {
  console.error('âŒ Error:', err.message);
  res.status(500).json({ error: 'Lá»—i server ná»™i bá»™' });
});

app.listen(3000, () => console.log('âœ… Server cháº¡y á»Ÿ cá»•ng 3000'));

ðŸ“„ middlewares/logger.js
---------------------
module.exports = (req, res, next) => {
  console.log(`ðŸ“¥ ${req.method} - ${req.originalUrl}`);
  next();
};

ðŸ“„ middlewares/validateUser.js
---------------------
module.exports = (req, res, next) => {
  const { name, email } = req.body;
  if (!name || !email) {
    return res.status(400).json({ error: 'Thiáº¿u name hoáº·c email' });
  }
  next();
};

ðŸ“„ routes/user.route.js
---------------------
const express = require('express');
const router = express.Router();
const userController = require('../controllers/user.controller');
const validateUser = require('../middlewares/validateUser');
const log = require('../middlewares/logger');

router.use(log); // middleware toÃ n bá»™ route

router.get('/', userController.getAllUsers);
router.get('/:id', userController.getUserById);
router.post('/', validateUser, userController.createUser);
router.put('/:id', validateUser, userController.updateUser);
router.delete('/:id', userController.deleteUser);

module.exports = router;
