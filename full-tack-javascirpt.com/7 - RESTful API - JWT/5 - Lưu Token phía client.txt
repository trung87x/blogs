===========================================
ğŸ§© Ngá»¯ cáº£nh #5: LÆ°u Token phÃ­a client
===========================================

ğŸ§  MÃ´ hÃ¬nh (Model) â€“ Ã nghÄ©a:
Sau khi backend tráº£ vá» JWT token sau khi Ä‘Äƒng nháº­p, 
client cáº§n lÆ°u token Ä‘á»ƒ sá»­ dá»¥ng trong cÃ¡c request tiáº¿p theo.

CÃ³ 2 lá»±a chá»n phá»• biáº¿n:
1. LÆ°u vÃ o localStorage hoáº·c sessionStorage
2. LÆ°u vÃ o HTTP-only Cookie (báº£o máº­t hÆ¡n)

---

ğŸ“¦ LÆ°u token vÃ o localStorage (phá»• biáº¿n vá»›i SPA):
Dá»… dÃ¹ng, dá»… triá»ƒn khai trong React / Vue / JS thuáº§n

ğŸ“„ VÃ­ dá»¥ (React hoáº·c JS thuáº§n):
// Sau khi Ä‘Äƒng nháº­p thÃ nh cÃ´ng
localStorage.setItem('token', response.data.token);

// Khi gá»i API cÃ³ báº£o vá»‡
const token = localStorage.getItem('token');

fetch('http://localhost:3000/api/profile', {
  method: 'GET',
  headers: {
    Authorization: `Bearer ${token}`
  }
});

---

ğŸ“¦ LÆ°u token vÃ o cookie HTTP-only:
An toÃ n hÆ¡n vÃ¬ JavaScript khÃ´ng Ä‘á»c Ä‘Æ°á»£c token â†’ trÃ¡nh XSS

ğŸ“„ Express backend gá»­i token qua cookie:
res.cookie('token', token, {
  httpOnly: true,
  secure: true, // báº¯t buá»™c náº¿u dÃ¹ng HTTPS
  sameSite: 'Strict',
  maxAge: 3600000 // 1 giá»
});

ğŸ“„ Client fetch cáº§n thÃªm `credentials: 'include'`:
fetch('http://localhost:3000/api/profile', {
  method: 'GET',
  credentials: 'include'
});

ğŸ“„ Backend cáº§n cáº¥u hÃ¬nh CORS cho cookie:
const cors = require('cors');

app.use(cors({
  origin: 'http://localhost:3001', // Ä‘á»‹a chá»‰ frontend
  credentials: true
}));

---

ğŸ“Œ GHI CHÃš QUAN TRá»ŒNG:

âœ… localStorage:
- Æ¯u: Triá»ƒn khai Ä‘Æ¡n giáº£n, dá»… debug
- NhÆ°á»£c: Dá»… bá»‹ táº¥n cÃ´ng XSS náº¿u frontend khÃ´ng báº£o vá»‡ tá»‘t

âœ… HTTP-only Cookie:
- Æ¯u: Báº£o máº­t cao hÆ¡n vÃ¬ token khÃ´ng truy cáº­p qua JS
- NhÆ°á»£c: Phá»©c táº¡p hÆ¡n, cáº§n cáº¥u hÃ¬nh CORS Ä‘Ãºng

âœ… Token háº¿t háº¡n â†’ cáº§n logout hoáº·c refresh token

âœ… KhÃ´ng lÆ°u token trong biáº¿n toÃ n cá»¥c hoáº·c context náº¿u khÃ´ng mÃ£ hoÃ¡

âœ… Cookie cáº§n thÃªm:
  - httpOnly: true
  - secure: true
  - sameSite: 'Strict' hoáº·c 'Lax'
  - credentials: 'include' bÃªn phÃ­a client